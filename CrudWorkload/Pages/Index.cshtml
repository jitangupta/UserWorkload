@page
@model IndexModel
@{
    ViewData["Title"] = "Home";
}

<div id="db-loading" class="text-center mt-5">
    <div class="spinner-border text-primary" role="status"></div>
    <div class="mt-3">Waking up the database, please wait...</div>
</div>

<div id="main-content" style="display:none;">
    <div class="container mt-4">
        <div class="card mb-4">
            <div class="card-body">
                <h2 class="card-title">UserWorkload Project Overview</h2>
                <p>
                    This project demonstrates a secure user management system built with ASP.NET Core Razor Pages. Key features include:
                </p>
                <ul>
                    <li><strong>User Create:</strong> Register new users securely.</li>
                    <li><strong>Login:</strong> Authenticate users with secure credential handling.</li>
                    <li><strong>View Profile in Navbar:</strong> Authenticated users can see their profile picture and name in the navigation bar.</li>
                </ul>
                <h5 class="mt-4">Tech Stack</h5>
                <ul>
                    <li><strong>Azure Storage:</strong> Securely stores user profile images and attachments.</li>
                    <li><strong>Azure SQL:</strong> Stores user data and application information.</li>
                    <li><strong>Azure Key Vault:</strong> Manages sensitive configuration and secrets.</li>
                    <li><strong>Azure Container Instance:</strong> Application is deployed in a scalable, containerized environment.</li>
                </ul>
            </div>
        </div>
    </div>
</div>

@section Scripts {
<script>
    async function checkDbStatus() {
        try {
            const res = await fetch('/api/dbstatus');
            const data = await res.json();
            if (data.status === "ready") {
                document.getElementById('db-loading').style.display = 'none';
                document.getElementById('main-content').style.display = '';
            } else {
                setTimeout(checkDbStatus, 2000);
            }
        } catch {
            setTimeout(checkDbStatus, 2000);
        }
    }
    checkDbStatus();
</script>
}
